<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LFG Site</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        /* Basic reset and body styling */
        body {
            margin: 0;
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #1e3c72, #2a5298);
            color: #fff;
            padding: 20px;
            box-sizing: border-box;
        }

        /* Center content and add padding */
        #mainContent {
            max-width: 800px;
            margin: 0 auto;
            background: rgba(0, 0, 0, 0.7);
            padding: 20px;
            border-radius: 8px;
        }

        /* Style for headings */
        h1, h2 {
            text-align: center;
            margin: 0;
        }

        /* Auth form styling */
        .auth-form {
            background: rgba(0, 0, 0, 0.8);
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            margin: 20px 0;
        }
        
        .auth-form input {
            display: block;
            margin: 10px 0;
            padding: 10px;
            width: 100%;
            border: 1px solid #444;
            border-radius: 4px;
            background: #222;
            color: #fff;
        }

        .auth-form button {
            padding: 10px;
            width: 100%;
            border: none;
            border-radius: 4px;
            background: #007bff;
            color: #fff;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .auth-form button:hover {
            background: #0056b3;
        }

        /* Style for form elements */
        form {
            margin: 20px 0;
        }

        label {
            display: block;
            margin: 10px 0 5px;
        }

        select, button {
            margin: 5px 0;
            padding: 10px;
            width: 100%;
            border: 1px solid #444;
            border-radius: 4px;
            background: #222;
            color: #fff;
        }

        select:focus, button:focus {
            outline: none;
            box-shadow: 0 0 5px #007bff;
        }

        button:hover {
            background: #0056b3;
        }

        /* Card style for group items */
        #groupList {
            margin-top: 20px;
        }

        .group-item {
            border: 1px solid #444;
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            transition: transform 0.3s ease, background 0.3s ease;
        }

        .group-item:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.02);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            #mainContent {
                padding: 10px;
            }

            .auth-form, form, #groupList {
                padding: 10px;
            }

            .auth-form input, .auth-form button, select, button {
                font-size: 16px;
            }
        }
    </style>
</head>
<body>
    <h1>Titan LFG</h1>

    <!-- Authentication Forms -->
    <div class="auth-form" id="authForm">
        <h2>Register</h2>
        <input type="email" id="registerEmail" placeholder="Email" />
        <input type="password" id="registerPassword" placeholder="Password" />
        <button onclick="register()">Register</button>

        <h2>Login</h2>
        <input type="email" id="loginEmail" placeholder="Email" />
        <input type="password" id="loginPassword" placeholder="Password" />
        <button onclick="login()">Login</button>
    </div>

    <!-- Main content for group creation -->
    <div id="mainContent" style="display: none;">
        <form id="lfgForm">
            <button type="button" onclick="createGroup()">Create Group</button>
            <button type="button" onclick="selectMission('Void Farming')">Void Farming</button>
            <button type="button" onclick="selectMission('Calling of the Descendants')">Calling of the Descendants</button>
            <button type="button" onclick="selectMission('Encrypted Vaults')">Encrypted Vaults</button>
            <button type="button" onclick="selectMission('Zone Farming')">Zone Farming</button>
            <button type="button" onclick="selectMission('Normal Void Battles')">Normal Void Battles</button>
            <button type="button" onclick="selectMission('Hard Void Battles')">Hard Void Battles</button>
            <button type="button" onclick="donate()">Donate</button>
            
            <label for="missionType">Select a Mission Type:</label>
            <select id="missionType" onchange="updateLevels()">
                <option value="">Select Mission Type</option>
                <option value="Void Farming">Void Farming</option>
                <option value="Calling of the Descendants">Calling of the Descendants</option>
                <option value="Normal Void Battles">Normal Void Battles</option>
                <option value="Hard Void Battles">Hard Void Battles</option>
                <option value="Encrypted Vaults">Encrypted Vaults</option>
                <option value="Zone Farming">Zone Farming</option>
            </select>

            <label for="missionLevel">What is your Objective:</label>
            <select id="missionLevel">
                <option value="">Select Mission Level</option>
            </select>
        </form>

        <!-- Recently created groups list -->
        <div id="groupList">
            <h2>Recently Created Groups</h2>
            <!-- Groups will be listed here -->
        </div>
    </div>

    <!-- Background music -->
    <audio id="backgroundMusic" autoplay loop>
        <source src="background-music.mp3" type="audio/mpeg">
        Your browser does not support the audio element.
    </audio>

    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.6/firebase-app.js";
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/9.6.6/firebase-auth.js";
        import { getFirestore, collection, addDoc, onSnapshot, query, orderBy, limit } from "https://www.gstatic.com/firebasejs/9.6.6/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyDkXMlEkORvvfH-kBYbBLAfasBoCsHCQmQ",
            authDomain: "titan1lfg.firebaseapp.com",
            projectId: "titan1lfg",
            storageBucket: "titan1lfg.appspot.com",
            messagingSenderId: "51631664886",
            appId: "1:51631664886:web:1f9660b9a81b3c945446d7",
            measurementId: "G-VG05WVY53Q"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        window.register = function() {
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;
            createUserWithEmailAndPassword(auth, email, password)
                .then((userCredential) => {
                    alert('Registration successful!');
                    document.getElementById('mainContent').style.display = 'block';
                    document.getElementById('authForm').style.display = 'none';
                })
                .catch((error) => {
                    alert('Error: ' + error.message);
                });
        }

        window.login = function() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            signInWithEmailAndPassword(auth, email, password)
                .then((userCredential) => {
                    alert('Login successful!');
                    document.getElementById('mainContent').style.display = 'block';
                    document.getElementById('authForm').style.display = 'none';
                })
                .catch((error) => {
                    alert('Error: ' + error.message);
                });
        }

        window.createGroup = async function() {
            const missionType = document.getElementById('missionType').value;
            const missionLevel = document.getElementById('missionLevel').value;
            if (!missionType || !missionLevel) {
                alert('Please select both mission type and mission level.');
                return;
            }

            try {
                await addDoc(collection(db, "groups"), {
                    type: missionType,
                    level: missionLevel,
                    createdAt: new Date()
                });
                alert('Group created successfully!');
                loadGroups();
            } catch (error) {
                alert('Error: ' + error.message);
            }
        }

        window.selectMission = function(type) {
            document.getElementById('missionType').value = type;
            updateLevels();
        }

        window.donate = function() {
            alert('Thank you for your donation!');
        }

        function updateLevels() {
            const missionType = document.getElementById('missionType').value;
            const levels = {
                'Void Farming': ['Level 1', 'Level 2', 'Level 3'],
                'Calling of the Descendants': ['Easy', 'Medium', 'Hard'],
                'Normal Void Battles': ['Beginner', 'Intermediate', 'Advanced'],
                'Hard Void Battles': ['Hard', 'Very Hard', 'Extreme'],
                'Encrypted Vaults': ['Vault 1', 'Vault 2', 'Vault 3'],
                'Zone Farming': ['Zone 1', 'Zone 2', 'Zone 3']
            };

            const levelSelect = document.getElementById('missionLevel');
            levelSelect.innerHTML = '<option value="">Select Mission Level</option>'; // Clear previous options

            if (levels[missionType]) {
                levels[missionType].forEach(level => {
                    const option = document.createElement('option');
                    option.value = level;
                    option.textContent = level;
                    levelSelect.appendChild(option);
                });
            }
        }

        async function loadGroups() {
            const q = query(collection(db, "groups"), orderBy("createdAt", "desc"), limit(10));
            onSnapshot(q, (querySnapshot) => {
                const groupList = document.getElementById('groupList');
                groupList.innerHTML = '<h2>Recently Created Groups</h2>'; // Clear previous list

                querySnapshot.forEach((doc) => {
                    const groupData = doc.data();
                    const groupItem = document.createElement('div');
                    groupItem.className = 'group-item';
                    groupItem.innerHTML = `<strong>Type:</strong> ${groupData.type} <br> <strong>Level:</strong> ${groupData.level} <br> <strong>Created:</strong> ${new Date(groupData.createdAt.seconds * 1000).toLocaleString()}`;
                    groupList.appendChild(groupItem);
                });
            });
        }
    </script>
</body>
</html>
